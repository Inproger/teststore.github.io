<!DOCTYPE html>
<html lang="az">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SÉ™bÉ™tim | Test Store</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<header class="navbar">
  <a class="back-btn" href="index.html" style="color:white; text-decoration:none;">â¬… Geri</a>
  <div class="logo">SÉ™bÉ™tim</div>
  <div style="width: 50px;"></div>
</header>

<main class="cart-container">
  <div id="cartItems"></div>
  
  <div class="cart-summary" id="cartSummary">
    <div class="total-row" style="display:flex; justify-content:space-between; font-weight:bold; font-size:20px; margin-bottom:15px;">
      <span>CÉ™mi:</span>
      <span class="total-price"><span id="totalPrice">0</span> AZN</span>
    </div>

    <div class="payment-methods">
      <h3 style="margin-bottom:10px;">Ã–dÉ™niÅŸ Metodu</h3>
      <label class="pay-option" style="display:block; margin-bottom:10px; cursor:pointer;">
        <input type="radio" name="pay" checked> ğŸ’³ Bank KartÄ±
      </label>
      <label class="pay-option" style="display:block; margin-bottom:20px; cursor:pointer;">
        <input type="radio" name="pay" id="payWithBalance"> ğŸª™ Balansla Ã–dÉ™
      </label>
    </div>

    <button class="checkout-btn" onclick="checkout()" style="background:#1e88e5; font-size:18px; padding:15px;">Ã–dÉ™niÅŸi Tamamla</button>
  </div>
</main>

<script>
let cart = JSON.parse(localStorage.getItem("cart")) || [];

function renderCart() {
  const container = document.getElementById("cartItems");
  const summary = document.getElementById("cartSummary");
  let total = 0;
  container.innerHTML = "";

  if (cart.length === 0) {
    container.innerHTML = `
      <div style="text-align:center; padding:50px;">
        <div style="font-size:60px;">ğŸ›’</div>
        <p style="margin-top:15px; color:#666;">SÉ™bÉ™tiniz boÅŸdur.</p>
        <a href="index.html" style="display:inline-block; margin-top:20px; color:#1e88e5; text-decoration:none; font-weight:bold;">AlÄ±ÅŸ-veriÅŸÉ™ davam et</a>
      </div>`;
    summary.style.display = "none";
    return;
  }

  summary.style.display = "block";
  cart.forEach((item, index) => {
    total += item.price * item.qty;
    container.innerHTML += `
      <div class="cart-item">
        <img src="${item.img}" alt="">
        <div class="item-info">
          <h4>${item.name}</h4>
          <p style="color:#1e88e5; font-weight:bold;">${item.price} AZN</p>
        </div>
        <div class="item-actions">
          <div class="qty-control">
            <button onclick="changeQty(${index},-1)">âˆ’</button>
            <span>${item.qty}</span>
            <button onclick="changeQty(${index},1)">+</button>
          </div>
          <button class="del-btn" onclick="removeItem(${index})">ğŸ—‘ï¸</button>
        </div>
      </div>`;
  });
  document.getElementById("totalPrice").innerText = total.toFixed(2);
}

function changeQty(index, val) {
  cart[index].qty += val;
  if (cart[index].qty <= 0) cart.splice(index, 1);
  save();
}

function removeItem(index) {
  cart.splice(index, 1);
  save();
}

function save() {
  localStorage.setItem("cart", JSON.stringify(cart));
  renderCart();
}

function checkout() {
  let total = parseFloat(document.getElementById("totalPrice").innerText);
  let useBalance = document.getElementById("payWithBalance").checked;
  let currentBal = parseFloat(localStorage.getItem("balance")) || 0;

  if (useBalance) {
    if (currentBal < total) {
      if(confirm("Balansda pul yoxdur! Balans É™lavÉ™ etmÉ™yÉ™ gedÉ™k?")) location.href="index.html";
      return;
    }
    localStorage.setItem("balance", currentBal - total);
    alert("Ã–dÉ™niÅŸ uÄŸurla tamamlandÄ±! âœ…");
  } else {
    alert("SifariÅŸiniz qÉ™bul edildi! âœ…");
  }
  localStorage.removeItem("cart");
  location.href = "index.html";
}

renderCart();
</script>
</body>
</html>
